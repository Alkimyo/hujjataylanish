services:
  - type: web
    name: unidoc
    env: python
    buildCommand: "pip install -r requirements.txt && python manage.py migrate && python manage.py collectstatic --noinput"
    startCommand: "gunicorn unidoc.wsgi:application --workers 1 --threads 2 --timeout 90 --max-requests 500 --max-requests-jitter 50"
    envVars:
      - key: WEB_CONCURRENCY
        value: "1"
      - key: MEDIA_ROOT
        value: "/var/data/media"
    disk:
      name: media
      mountPath: /var/data
      sizeGB: 1
